<!DOCTYPE html>
<html lang="en">
<head>
    <title>Plant Power Consumption</title>

    <!-- Adjusting the page on mobile screen -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <meta charset="utf-8">

    <!-- CSS -->
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" xintegrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    
    <style>
        .ui-content {
            text-align: center;
        }
        .ui-btn-inner {
            border-radius: 10px;
        }
        .password-field {
            font-size: 1.5em;
            text-align: left;
            letter-spacing: 0.2em;
        }
        #keypad .ui-controlgroup {
            margin: 0 auto;
            width: -moz-fit-content;
            width: -webkit-fit-content;
            width: fit-content;
        }
        #pageHome .ui-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 80vh; /* Adjust as needed */
        }
    </style>

    <!-- JavaScript -->
    <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
    <script>
        $(document).on('pageinit', '#pageHome', function(){
            // Function to add a value to the password field
            function addValueToPassword(value) {
                var passcodeField = $('#passcode');
                var currentPasscode = passcodeField.val();
                
                if (value === 'del') {
                    // Delete the last character
                    passcodeField.val(currentPasscode.slice(0, -1));
                } else {
                    // Add the new digit
                    if (currentPasscode.length < 4) { // Limit password length to 4 digits
                       passcodeField.val(currentPasscode + value);
                    }
                }
            }

            // Click handlers for the numeric keypad buttons
            $('#keypad a').on('click', function(e) {
                e.preventDefault(); // Prevent default link behavior
                var value = $(this).text().trim();
                addValueToPassword(value);
            });
            
            // Click handler for the 'del' button
            $('#btnDel').on('click', function(e) {
                e.preventDefault();
                addValueToPassword('del');
            });

            // Click handler for the 'Enter' button
            $('#btnEnter').on('click', function(e) {
                e.preventDefault();
                var enteredPasscode = $('#passcode').val();
                var correctPasscode = "2345";

                if (enteredPasscode === correctPasscode) {
                    sessionStorage.setItem('loggedIn', 'true');
                    // Redirect to legal notice page on first correct password
                    $.mobile.changePage("#legalNotice", { transition: "slide" });
                } else {
                    $('#resultMessage').html('<h2 style="color: red;">Login Failed!</h2><p>Incorrect passcode. Please try again.</p>');
                    // Navigate to the data page to show the error
                    $.mobile.changePage("#pageData", { transition: "slide" });
                }
                $('#passcode').val(''); // Clear the password field
            });
        });

        $(document).on('click', '#noticeYes', function() {
            $.mobile.changePage("menu/menu.html", { transition: "slide" });
        });

        // A logout function that can be called from other pages
        function logout() {
            sessionStorage.removeItem('loggedIn');
            $.mobile.changePage("#pageHome", { transition: "slide" });
        }
    </script>
</head>
<body>

    <!-- Start of first page (Home) -->
    <div data-role="page" id="pageHome">
        <div data-role="header">
            <h1>Plant Power Consumption</h1>
            <a href="#pageAbout" data-role="button" data-icon="info" data-iconpos="right" data-inline="true">About</a>
        </div>
        <div data-role="content">
            <label for="passcode">Passcode:</label>
            <input type="password" id="passcode" class="password-field" maxlength="4" readonly />
            
            <!-- Numeric Keypad Container -->
            <div id="keypad">
                <div data-role="controlgroup" data-type="horizontal">
                    <a href="#" data-role="button">7</a>
                    <a href="#" data-role="button">8</a>
                    <a href="#" data-role="button">9</a>
                </div>
                <div data-role="controlgroup" data-type="horizontal">
                    <a href="#" data-role="button">4</a>
                    <a href="#" data-role="button">5</a>
                    <a href="#" data-role="button">6</a>
                </div>
                <div data-role="controlgroup" data-type="horizontal">
                    <a href="#" data-role="button">1</a>
                    <a href="#" data-role="button">2</a>
                    <a href="#" data-role="button">3</a>
                </div>
                <div data-role="controlgroup" data-type="horizontal">
                    <a href="#" data-role="button">0</a>
                    <a href="#" data-role="button" data-icon="delete" id="btnDel">del</a>
                </div>
            </div>

            <div data-role="controlgroup" data-type="horizontal">
                <a href="#" data-role="button" id="btnEnter">Enter</a>
            </div>
        </div>
    </div>

    <!-- Start of second page (Data) -->
    <div data-role="page" id="pageData">
        <div data-role="header">
            <a href="#pageHome" data-icon="arrow-l" data-rel="back" data-direction="reverse">Back</a>
            <h1>Data</h1>
        </div>
        <div data-role="content" id="resultMessage">
            <!-- Message will be dynamically updated by JavaScript -->
        </div>
    </div>

    <!-- Disclaimer Page (Legal Notice) -->
    <div data-role="page" id="legalNotice" data-close-btn="none">
        <div data-role="header">
            <h1>Disclaimer</h1>
        </div>
        <div data-role="content">
            <p>This application is for informational purposes only. The data displayed is not to be used for commercial or legal purposes. By clicking "Accept", you agree to these terms.</p>
            <br>
            <a href="#" data-ajax="false" data-role="button" data-icon="check" id="noticeYes">Accept</a>
        </div>
    </div>

    <!-- About Page -->
    <div data-role="page" id="pageAbout">
        <div data-role="header">
            <h1>Info</h1>
        </div>
        <div data-role="content">
            <p>This application is designed to simulate a dashboard for monitoring plant power consumption.</p>
        </div>
    </div>
</body>
</html>
